<!doctype html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="Displays temperature and presssure readings from a solar-powered monitor in Fairland Park, Harringay">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Fairland Park, Harringay</title>
    <link href="https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=en" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="css/material.min.css"><link rel="stylesheet" href="sz-iframesmall.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js">
</script>
<script>$(document).ready(function() {
setInterval(function()	{szpagenum = 1;	document.getElementById("szNumOfPage").innerHTML = szpagenum; szMain();  },15*60*60); // refresh every 1 minute
google.setOnLoadCallback(szMain); } ); 
///////////////////////////////////////////////////////////////
function szMain() {var szpagenum = 1;  var JSONPfeedURL='https://data.sparkfun.com/output/KJ36Y39YrVSZ0Rqxvdqv.json'; // http://phant.io/docs/output/http/
var obj={}; obj[0]=['datetime','timestamp'];obj[1]=['number','temp'];obj[2]=['number','pressure'];
var jsonPData = $.ajax({url: JSONPfeedURL, data: {page: szpagenum}, dataType: 'jsonp', }) // read the data from an external source
.done(function (results) {var elct=0;var therm1 = 0.0;  var press2 = 0.0; // draw a chart
	var szChartOut = new google.visualization.DataTable(); szChartOut.addColumn(obj[0][0], obj[0][1]); szChartOut.addColumn(obj[1][0], obj[1][1]); szChartOut.addColumn(obj[2][0], obj[2][1]);
	$.each(results, function (i, row) {elct++;therm1 = parseFloat(row.temp)-0.0 .toFixed(1); press2 = parseFloat(row.pressure)-1000 .toFixed(1);
		var szdate = new Date(row.timestamp); var szTooOld=new Date('2015-07-23 17:08:53');	if (szdate>szTooOld) {} // if (press2 < 1000) {return false;}
			szChartOut.addRow([ szdate,  therm1,  press2 ]); });
	var szLineChartOpts = {height:563,backgroundColor: "rgb(235, 255, 235)" , legend: {position: 'bottom'}, //  vAxes: {0: {logScale: false},  1: {logScale: false, maxValue: 1.5}},
	//legend:{position:'top'}, //  ,
	title: 'Readings from Fairland Park', subtitle: 'updated every 15 minutes',
	series: {0:{axis: 'temp'}, 1:{axis: 'pressure'}, scaleType:'allfixed' }, 
	axes:{
	y:{ temp: {label: 'Temperature in Celsius'},  pressure: {label: 'milliBars of Pressure above 1000'}  }, 
	x: { 0: {side: 'top', label: 'showing '+elct+ ' readings'} }   
	},
 
	}; 
    var szLineChart = new google.charts.Line($('#szLineChart').get(0));szLineChart.draw(szChartOut, google.charts.Line.convertOptions(szLineChartOpts));
    // Gauges use the first line of data - the latest  
	szThermVal=szChartOut.getFormattedValue(0,1);szPressVal=szChartOut.getFormattedValue(0,2);
	var szGaugeOpts = {width: 150, height: 150, redFrom: 26, redTo: 40,	yellowFrom:-10, yellowTo: 10, greenFrom:18, greenTo:25,minorTicks: 5, max:40, min: -10};
	szDrawGauge(szGaugeOpts,'szGaugeTherm',"\u00B0"+'C',parseFloat(szThermVal)); 
	var szGaugeOpts = {width: 150, height: 150, redFrom: 1027, redTo: 1040,	yellowFrom:1013, yellowTo: 1026, greenFrom:1001, greenTo:1012,minorTicks: 5, max:1040, min: 1001};
	szDrawGauge(szGaugeOpts,'szGaugePress','mBar',parseFloat(szPressVal)+1000);
	szReadDate=szChartOut.getFormattedValue(0,0);document.getElementById("szLastUpdate").innerHTML = szReadDate;
	///////////////////////////////////////////////
	function szDrawGauge(ff_opts,ff_div,ff_labelTop,ff_labelAndVal) {var dataMemory = google.visualization.arrayToDataTable([ ['Label', 'Value'], [ff_labelTop, ff_labelAndVal] ]);
		var chart = new google.visualization.Gauge(document.getElementById(ff_div)); chart.draw(dataMemory, ff_opts);}
}); }</script></head>
  <body>
    <div class="sz22-layout mdl-layout mdl-layout mdl-js-layout">
      <main class="mdl-layout__content  mdl-color--grey-100">
        <div class="mdl-grid sz22-content">
          <div class="sz22-charts mdl-cell  mdl-cell--1-col mdl-grid">
				<div id="szGaugeTherm" style="padding-right:20px;"></div><div id="szGaugePress" style="padding-left:20px;"></div>
          </div>
          <div class="sz22-graphs mdl-cell mdl-cell--1-col "><div id="szLineChart"></div>
		  <a href="#" class="mdl-button mdl-js-button mdl-js-ripple-effect">Page #<span id="szNumOfPage">1</span> updated: <span id="szLastUpdate">1</span></a>
		  </div>
        </div>
      </main>
    </div>
<script src="js/material.min.js"></script><script type="text/javascript" 
src="https://www.google.com/jsapi?autoload={'modules':[{'name':'visualization','version':'1.1','packages':['line','gauge']}]}"></script>
</body></html>